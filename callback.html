<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Connecting Discord…</title>
</head>
<body>
  <h1>Connecting your Discord Account…</h1>

  <script>
    const url = new URL(window.location.href);
    const code = url.searchParams.get("code");

    if (!code) {
      document.body.innerHTML = "<h1>Error: Missing ?code</h1>";
    } else {
      // Send code to your Node.js server
      fetch(`https://discord-oauth-server-xnw3.onrender.com/auth/callback?code=${code}`)
  .then(res => res.json())
  .then(user => {
    // save user data to localStorage for your dashboard
    localStorage.setItem("discord_user", JSON.stringify(user));
    window.location.href = "/"; // redirect back to your dashboard
  })
  .catch(err => console.error(err));

        .then(res => res.json())
        .then(user => {
          // Save user info in localStorage so the dashboard can read it
          localStorage.setItem("discord_user", JSON.stringify(user));
          window.location.href = "https://jejekingyt.github.io/Dashboard/";
        });
    }
  </script>
</body>
</html>
